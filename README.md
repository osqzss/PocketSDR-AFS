# PocketSDR-AFS

PocketSDR-AFS is an enhanced version of Tomoji Takasuâ€™s [PocketSDR v0.13](https://github.com/tomojitakasu/PocketSDR) designed to support the Augmented Forward Signal (AFS) for the Lunar Augmented Navigation Service (LANS).

LANS is the lunar counterpart to GNSS, developed to enable precise navigation and positioning for future lunar exploration missions. The AFS is a standardized signal structure for LANS. It is transmitted by multiple LunaNet Service Provider (LNSP) nodes, including NASA's Lunar Communications Relay and Navigation Systems (LCRNS) and JAXA's Luna Navigation Satellite System (LNSS). The recommended standard for AFS can be found at NASA's [LunaNet Interoperability Specification](https://www.nasa.gov/directorates/somd/space-communications-navigation-program/lunanet-interoperability-specification/) site.

PocketSDR-AFS, in conjunction with a software-defined LANS AFS baseband simulator such as [LANS-AFS-SIM](https://github.com/osqzss/LANS-AFS-SIM), offers a flexible platform for validating LANS signal processing algorithms and evaluating lunar navigation performance.

## Build Instructions

### 1. Install Prerequisite Packages

```sh
sudo apt update
sudo apt install libusb-1.0-0-dev libfftw3-dev
```

### 2. Clone the Repository

```sh
git clone https://github.com/osqzss/PocketSDR-AFS.git
cd PocketSDR-AFS
```

### 3. Install External Library Source Trees

```sh
cd lib
chmod +x clone_lib.sh
./clone_lib.sh
```

### 4. Build the Libraries

```sh
cd build
make
make install
```

### 5. Build the `pocket_trk` Executable

```sh
cd ../../app/pocket_trk
make
```

## Usage

The `pocket_trk.sh` script in `app/pocket_trk` provides example command-line instructions for both offline and real-time testing:

- **Offline Testing:** Process 2-bit I/Q sample data generated by LANS-AFS-SIM.
- **Real-time Testing:** Use with the FE2CH frontend on a desktop PC or Raspberry Pi 5.

### Offline Testing Example

```sh
sudo ./pocket_trk.sh afssim_ip2.bin
```

### Real-time Testing Example (with FE2CH frontend)

```sh
sudo ./pocket_trk.sh
```

## Notes

- For development and testing purposes, the center frequency of the LANS AFS is set to 1575.42MHz. While the actual LANS AFS is transmitted in the S-band, this L-band configuration enables compatibility with the FE2CH frontend device, facilitating convenient real-time testing on desktop PCs or Raspberry Pi devices.
- To configure the receiver for S-band signal acquisition, edit the `src/pocket_sdr.h` file and comment out the `#define DEMO_L1` directive. This modification enables support for the S-band center frequency used by the actual LANS AFS broadcast.
